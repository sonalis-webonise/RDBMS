sudo su- postgres
psql

create database ecommercedb
 \c ecommercedb

create table users(
user_id integer NOT NULL,
user_name varchar(50),
email_id varchar(50),
user_password varchar(50),
contact varchar(10),
PRIMARY KEY(user_id),
CONSTRAINT email CHECK (email_id ~* '^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+[.][A-Za-z]+$'),
CONSTRAINT password_len CHECK (length(user_password) >= 8),
CONSTRAINT contact CHECK ( contact LIKE '%[^0-9]%' AND length(contact)=10)
);

select * from users;
drop table users;
alter table users add user_type varchar(50);
alter table users alter column contact type real USING contact::real;


create table products(
product_id integer NOT NULL,
product_name varchar(50),
product_description varchar(300),
product_color varchar(50),
product_price int,
user_id int references users(user_id),
PRIMARY KEY(product_id)
);

alter table products drop column user_id;

create table product_cart(
cart_item_id integer NOT NULL,
product_id int references products(product_id),
PRIMARY KEY(cart_item_id)
);

create table orders(
order_id integer NOT NULL,
order_quantity int,
discount int,
user_id int references users(user_id),
cart_item_id int references product_cart(cart_item_id),
PRIMARY KEY(order_id)
);

create table payments(
payment_id integer NOT NULL,
payment_status varchar(50),
total_cost int,
user_id int references users(user_id),
order_id int references orders(order_id),
PRIMARY KEY(payment_id)
);


create table order_status(
status_id integer NOT NULL,
status_order varchar(50),
user_id int references users(user_id),
order_id int references orders(order_id),
payment_id int references payments(payment_id),
PRIMARY KEY(status_id)
);
